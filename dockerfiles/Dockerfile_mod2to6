# Base image: OpenJDK 17 (recommended for modern Java tools)
FROM openjdk:17-jdk-slim

# Set working directory
WORKDIR /app

# Copy your main jar, along with the required libraries, and the pipeline script into the image
COPY jars/jcna-biomrkrs-v11.2.3.jar /app/jars/
COPY jars/libs/all-libraries.jar /app/libs/
COPY jars/libs/zstd-jni-1.5.7-4-linux_amd64.jar /app/libs/
COPY scripts/run_pipeline_module2to6.sh /app/

# Copy your logging config (optional)
COPY config/log4j2.xml /app/config/

# Optional: set Java heap default (can still be overridden)
ENV JAVA_HEAP=32g

# Define the classpath environment variable
ENV CLASSPATH=/app/jars/jcna-biomrkrs-v11.2.3.jar:/app/libs/all-libraries.jar:/app/libs/zstd-jni-1.5.7-4-linux_amd64.jar

# Default entrypoint (you can override this in Galaxy)
# ENTRYPOINT ["java", "-Xmx32g", "-Dlog4j.configurationFile=/app/config/log4j2.xml", "task.test.Jcna_input"]
ENTRYPOINT ["bash", "/app/run_pipeline_module2to6.sh"]


